function wFORMS(){function switchScope(e){for(;e;){if(e.className&&(-1!=(" "+e.className+" ").indexOf(" "+self.className_repeat+" ")||-1!=(" "+e.className+" ").indexOf(" "+self.className_delete+" ")))return e;if(e.tagName.toUpperCase()==self.switchScopeRootTag)return e;e=e.parentNode}return null}function switchState(e,t,a){if(1==e.nodeType){e.className&&-1!=e.className.indexOf(t)&&(e.className=e.className.replace(t,a));for(var s=0;s<e.childNodes.length;s++)switchState(e.childNodes[s],t,a)}}function removeRepeatCountSuffix(e){return e.replace(/-\d$/,"")}function replicateTree(e,t,a){switch(e.nodeType){case 1:if(-1!=e.className.indexOf(self.className_duplicateLink)||-1!=e.className.indexOf(self.className_removeLink))return null;if(-1!=e.className.indexOf(self.className_delete))return null;if(-1!=e.className.indexOf(self.className_repeat)&&null!=t&&(a=a.replace("-","__")),document.all&&!window.opera){var s=e.tagName;if(e.name&&(s+="INPUT"==e.tagName.toUpperCase()&&"radio"==e.type.toLowerCase()&&self.preserveRadioName?" NAME='"+e.name+"' ":" NAME='"+removeRepeatCountSuffix(e.name)+a+"' "),e.type&&(s+=" TYPE='"+e.type+"' "),e.selected&&(s+=" SELECTED='SELECTED' "),e.checked&&(s+=" CHECKED='CHECKED' "),-1!=navigator.appVersion.indexOf("MSIE")&&-1==navigator.appVersion.indexOf("Windows"))var i=document.createElement(s);else var i=document.createElement("<"+s+"></"+e.tagName+">");try{i.type=e.type}catch(r){}}else var i=document.createElement(e.tagName);for(var n=0;n<e.attributes.length;n++)if(e.attributes[n].specified||"value"==e.attributes[n].nodeName.toLowerCase()){if("id"==e.attributes[n].nodeName.toLowerCase()||"name"==e.attributes[n].nodeName.toLowerCase()||"for"==e.attributes[n].nodeName.toLowerCase())if(-1!=e.attributes[n].nodeValue.indexOf(self.idSuffix_fieldHint)){var o=e.attributes[n].nodeValue;o=removeRepeatCountSuffix(o.substr(0,o.indexOf(self.idSuffix_fieldHint)))+a+self.idSuffix_fieldHint}else if("INPUT"==e.tagName.toUpperCase()&&"radio"==e.getAttribute("type",!1).toLowerCase()&&"name"==e.attributes[n].nodeName.toLowerCase()&&self.preserveRadioName)var o=e.attributes[n].nodeValue;else var o=e.attributes[n].nodeValue+a;else if("value"!=e.attributes[n].nodeName.toLowerCase()||"INPUT"!=e.tagName.toUpperCase()||"text"!=e.type.toLowerCase()&&"password"!=e.type.toLowerCase()&&"file"!=e.type.toLowerCase())var o=e.attributes[n].nodeValue;else var o="";switch(e.attributes[n].nodeName.toLowerCase()){case"class":i.className=o;break;case"style":e.style&&e.style.cssText&&(i.style.cssText=e.style.cssText);break;case"onclick":i.onclick=e.onclick;break;case"onchange":i.onchange=e.onchange;break;case"onsubmit":i.onsubmit=e.onsubmit;break;case"onmouseover":i.onmouseover=e.onmouseover;break;case"onmouseout":i.onmouseout=e.onmouseout;break;case"onmousedown":i.onmousedown=e.onmousedown;break;case"onmouseup":i.onmouseup=e.onmouseup;break;case"ondblclick":i.ondblclick=e.ondblclick;break;case"onkeydown":i.onkeydown=e.onkeydown;break;case"onkeyup":i.onkeyup=e.onkeyup;break;case"onblur":i.onblur=e.onblur;break;case"onfocus":i.onfocus=e.onfocus;break;default:i.setAttribute(e.attributes[n].name,o,0)}}break;case 3:if("TEXTAREA"!=e.parentNode.tagName.toUpperCase())var i=document.createTextNode(e.data)}t&&i&&t.appendChild(i);for(var n=0;n<e.childNodes.length;n++)replicateTree(e.childNodes[n],i,a);return i}function checkOneRequired(e){var t=null;if(1!=e.nodeType)return!1;if("INPUT"==e.tagName.toUpperCase())switch(e.type.toLowerCase()){case"checkbox":t=e.checked;break;case"radio":t=e.checked;break;default:t=e.value}else t=e.value;if(t&&!self.isEmpty(t))return!0;for(var a=0;a<e.childNodes.length;a++)if(checkOneRequired(e.childNodes[a]))return!0;return!1}var wu=new wUTILITY,self=this;this.classNamePrefix_switch="switch",this.className_switchIsOn="swtchIsOn",this.classNamePrefix_offState="offstate",this.classNamePrefix_onState="onstate",this.className_repeat="repeat",this.className_delete="removeable",this.className_required="required",this.className_validationError_msg="errMsg",this.className_validationError_fld="errFld",this.classNamePrefix_validation="validate",this.className_duplicateLink="duplicateLink",this.className_removeLink="removeLink",this.className_activeFieldHint="field-hint",this.className_inactiveFieldHint="field-hint-inactive",this.className_paging="wfPage",this.className_pagingCurrent="wfCurrentPage",this.className_pagingButtons="wfPageButton",this.className_hideSubmit="wfHideSubmit",this.idSuffix_fieldHint="-H",this.idSuffix_fieldLabel="-L",this.idSuffix_fieldError="-E",this.idSuffix_repeatCounter="-RC",this.idSuffix_duplicateLink="-wfDL",this.idPrefix_pageIndex="wfPgIndex-",this.preserveRadioName=!0,this.switchScopeRootTag="FORM",this.functionName_formValidation="this.formValidation",this.showAlertOnError=!0,this.preventSubmissionOnEnter=!1,this.arrErrorMsg=new Array,this.arrErrorMsg[0]="This field is required. ",this.arrErrorMsg[1]="The text must use alphabetic characters only (a-z, A-Z). Numbers are not allowed. ",this.arrErrorMsg[2]="This does not appear to be a valid email address.",this.arrErrorMsg[3]="Please enter an integer.",this.arrErrorMsg[4]="Please enter a float (ex. 1.9).",this.arrErrorMsg[5]="Unsafe password. Your password should be between 4 and 12 characters long and use a combinaison of upper-case and lower-case letters.",this.arrErrorMsg[6]="Please use alpha-numeric characters only [a-z 0-9].",this.arrErrorMsg[7]="This does not appear to be a valid date.",this.arrErrorMsg[8]="%% error(s) detected. Your form has not been submitted yet.\nPlease check the information you provided.",this.arrMsg=new Array,this.arrMsg[0]="Add a row",this.arrMsg[1]="Repeats the preceding field or field group.",this.arrMsg[2]="Remove",this.arrMsg[3]="Removes the preceding field or field group.",this.arrMsg[4]="Next Page",this.arrMsg[5]="Previous Page",this.utilities=wu,this.refreshAllStates=function(e){wu.debug("refreshAll:"+e);var t=document.getElementById(e);if(t)for(var a=wu.getElements(t),s=0;s<a.length;s++)if("SELECT"==a[s].tagName.toUpperCase()&&wu.isEventHandled(a[s],"change")&&this.refreshState(null,a[s]),a[s].className&&-1!=a[s].className.indexOf(this.classNamePrefix_switch))switch(a[s].tagName.toUpperCase()){case"OPTION":break;default:this.refreshState(null,a[s],!0)}},this.refreshState=function(e){var t=!1;if(!e&&arguments.length>1){var a=arguments[1];arguments.length>2&&(t=arguments[2])}else var a=wu.getSrcElement(e);switch(a.tagName.toUpperCase()){case"SELECT":for(var s="",i=switchScope(a),r=0;r<a.options.length;r++)if(-1!=a.options[r].className.indexOf(self.classNamePrefix_switch)){var n=a.options[r].className;n=n.substr(n.indexOf(self.classNamePrefix_switch)).split(" ")[0].substr(self.classNamePrefix_switch.length);var o=self.classNamePrefix_offState+n,l=self.classNamePrefix_onState+n;r==a.selectedIndex?(switchState(i,o,l),s=l):l!=s&&switchState(i,l,o)}break;case"INPUT":if("radio"==a.type.toLowerCase())for(var r=0;r<a.form[a.name].length;r++){var d=a.form[a.name][r];if(d.className&&-1!=d.className.indexOf(self.classNamePrefix_switch)){var n=d.className;n=n.substr(n.indexOf(self.classNamePrefix_switch)).split(" ")[0].substr(self.classNamePrefix_switch.length);var o=self.classNamePrefix_offState+n,l=self.classNamePrefix_onState+n;d.checked?switchState(switchScope(d),o,l):switchState(switchScope(d),l,o)}}else{var n=a.className;n=n.substr(n.indexOf(self.classNamePrefix_switch)).split(" ")[0].substr(self.classNamePrefix_switch.length);var o=self.classNamePrefix_offState+n,l=self.classNamePrefix_onState+n;a.checked||"button"==a.type.toLowerCase()&&a!=arguments[1]&&-1==a.className.indexOf(self.className_switchIsOn)?(switchState(switchScope(a),o,l),"button"==a.type.toLowerCase()&&(a.className+=" "+self.className_switchIsOn)):t||(switchState(switchScope(a),l,o),"button"==a.type.toLowerCase()&&a!=arguments[1]&&(a.className=a.className.replace(self.className_switchIsOn,"")))}break;default:var n=a.className;n=n.substr(n.indexOf(self.classNamePrefix_switch)).split(" ")[0].substr(self.classNamePrefix_switch.length);var o=self.classNamePrefix_offState+n,l=self.classNamePrefix_onState+n;a!=arguments[1]&&-1==a.className.indexOf(self.className_switchIsOn)?(switchState(switchScope(a),o,l),a.className+=" "+self.className_switchIsOn):a!=arguments[1]&&(switchState(switchScope(a),l,o),a.className=a.className.replace(self.className_switchIsOn,""))}},this.duplicateFieldGroup=function(e){for(var t=wu.getSrcElement(e),a=t.parentNode;a&&(!a.className||-1==(" "+a.className+" ").indexOf(" "+self.className_repeat+" "));)a=a.parentNode;if(a&&-1!=a.className.indexOf(self.className_repeat)){if(counterField=document.getElementById(a.id+self.idSuffix_repeatCounter),!counterField)return;for(var s=parseInt(counterField.value)+1,i="-"+s.toString(),r=replicateTree(a,null,i),n=a.nextSibling;n&&(3==n.nodeType||1==n.nodeType&&n.className&&-1!=n.className.indexOf(self.className_delete));)n=n.nextSibling;a.parentNode.insertBefore(r,n),r.className=a.className.replace(self.className_repeat,self.className_delete),document.getElementById(a.id+self.idSuffix_repeatCounter).value=s,r.id||(r.id=wu.randomId()+i),wu.debug("Duplicated tree id : "+r.id),self.addBehaviors(r.id),"undefined"!=typeof Fat&&Fat&&r.id&&Fat.fade_element(r.id,10,600,"#FFFFCC","#FFFFFF")}return wu.XBrowserPreventEventDefault(e)},this.removeFieldGroup=function(e){for(var t=wu.getSrcElement(e),a=t.parentNode;a&&-1==(" "+a.className+" ").indexOf(" "+self.className_delete+" ");)a=a.parentNode;return a.parentNode.removeChild(a),wu.XBrowserPreventEventDefault(e)},this.activateFieldHint=function(e){var t=wu.getSrcElement(e),a=document.getElementById(t.id+self.idSuffix_fieldHint);a||"INPUT"!=t.tagName.toUpperCase()||"radio"!=t.type.toLowerCase()||(a=document.getElementById(t.name+self.idSuffix_fieldHint)),a&&(a.className=a.className.replace(self.className_inactiveFieldHint,self.className_activeFieldHint))},this.desactivateFieldHint=function(e){var t=wu.getSrcElement(e),a=document.getElementById(t.id+self.idSuffix_fieldHint);a||"INPUT"!=t.tagName.toUpperCase()||"radio"!=t.type.toLowerCase()||(a=document.getElementById(t.name+self.idSuffix_fieldHint)),a&&(a.className=a.className.replace(self.className_activeFieldHint,self.className_inactiveFieldHint))},this.pagingNext=function(e){var srcE=wu.getSrcElement(e),curPageDiv=srcE.parentNode,pageIndex=parseInt(curPageDiv.id.replace(/[\D]*/,""))+1,pageDiv=document.getElementById(self.idPrefix_pageIndex+pageIndex.toString());if(pageDiv&&eval(self.functionName_formValidation.replace("this","self"))(e)){curPageDiv.className=curPageDiv.className.replace(self.className_pagingCurrent,""),pageDiv.className+=" "+self.className_pagingCurrent,pageIndex++;var anotherpage=document.getElementById(self.idPrefix_pageIndex+pageIndex.toString());if(!anotherpage){var submitButton=document.getElementById("submit-"+srcE.form.id);submitButton&&(submitButton.className=submitButton.className.replace(self.className_hideSubmit,""))}}},this.pagingPrevious=function(e){var t=wu.getSrcElement(e),a=t.parentNode,s=parseInt(a.id.replace(/[\D]*/,""))-1,i=document.getElementById(self.idPrefix_pageIndex+s.toString());if(i){a.className=a.className.replace(self.className_pagingCurrent,""),i.className+=" "+self.className_pagingCurrent;var r=document.getElementById("submit-"+t.form.id);r&&-1==r.className.indexOf(self.className_hideSubmit)&&(r.className+=" "+self.className_hideSubmit)}},this.formValidation=function(e){var t=wu.getSrcElement(e);if(self.preventSubmissionOnEnter&&(e||(e=window.event),t.type&&"text"==t.type.toLowerCase()))return wu.XBrowserPreventEventDefault(e);for(;t&&"FORM"!=t.tagName.toUpperCase();)t=t.parentNode;for(var a=wu.getElements(t),s=0,i=!1,r=0;r<a.length;r++){var n=0;if(-1!=(" "+a[r].className+" ").indexOf(" "+self.className_required+" ")&&wu.checkVisibility(a[r])){i=!0;var o=!0;switch(a[r].tagName.toUpperCase()){case"INPUT":switch(a[r].getAttribute("type").toUpperCase()){case"CHECKBOX":o=a[r].checked;break;case"RADIO":o=a[r].checked;break;default:o=!self.isEmpty(a[r].value)}break;case"SELECT":o=!self.isEmpty(a[r].options[a[r].selectedIndex].value);break;case"TEXTAREA":o=!self.isEmpty(a[r].value);break;case"FIELDSET":o=checkOneRequired(a[r]);break;case"DIV":o=checkOneRequired(a[r]);break;case"SPAN":o=checkOneRequired(a[r]);break;case"TABLE":o=checkOneRequired(a[r]);break;case"TR":o=checkOneRequired(a[r]);break;case"TD":o=checkOneRequired(a[r])}if(o){var l=new RegExp(self.className_validationError_fld,"gi");a[r].className=a[r].className.replace(l,"");var d=document.getElementById(a[r].id+self.idSuffix_fieldError);d&&d.parentNode.removeChild(d)}else self.showError(a[r],self.arrErrorMsg[0]),n++}if(-1!=a[r].className.indexOf(self.classNamePrefix_validation)&&(i||(i=wu.checkVisibility(a[r])),i)){var c=a[r].className.split(" ");for(j=0;j<c.length;j++)switch(c[j]){case"validate-alpha":self.isAlpha(a[r].value)||(self.showError(a[r],self.arrErrorMsg[1]),n++);break;case"validate-alphanum":self.isAlphaNum(a[r].value)||(self.showError(a[r],self.arrErrorMsg[6]),n++);break;case"validate-date":self.isDate(a[r].value)||(self.showError(a[r],self.arrErrorMsg[7]),n++);break;case"validate-time":break;case"validate-email":self.isEmail(a[r].value)||(self.showError(a[r],self.arrErrorMsg[2]),n++);break;case"validate-integer":self.isInteger(a[r].value)||(self.showError(a[r],self.arrErrorMsg[3]),n++);break;case"validate-float":self.isFloat(a[r].value)||(self.showError(a[r],self.arrErrorMsg[4]),n++);break;case"validate-strongpassword":self.isPassword(a[r].value)||(self.showError(a[r],self.arrErrorMsg[5]),n++)}}if(n>0)s+=n;else{var l=new RegExp(self.className_validationError_fld,"gi");a[r].className=a[r].className.replace(l,"");var d=document.getElementById(a[r].id+self.idSuffix_fieldError);d&&d.parentNode.removeChild(d)}}return s>0?(self.showAlertOnError&&self.showAlert(s),wu.XBrowserPreventEventDefault(e)):!0},this.isEmpty=function(e){var t=/^\s+$/;return null==e||0==e.length||t.test(e)},this.isAlpha=function(e){var t=/^[a-zA-Z]+$/;return self.isEmpty(e)||t.test(e)},this.isAlphaNum=function(e){var t=/\W/;return self.isEmpty(e)||!t.test(e)},this.isDate=function(e){var t=new Date(e);return self.isEmpty(e)||!isNaN(t)},this.isEmail=function(e){var t=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;return self.isEmpty(e)||t.test(e)},this.isInteger=function(e){var t=/^[+]?\d+$/;return self.isEmpty(e)||t.test(e)},this.isFloat=function(e){return self.isEmpty(e)||!isNaN(parseFloat(e))},this.isPassword=function(e){return self.isEmpty(e)},this.showError=function(e,t){if(-1==e.className.indexOf(self.className_validationError_fld)){e.id||(e.id=wu.randomId()),e.className+=" "+self.className_validationError_fld;var a=document.createTextNode(" "+t),s=document.getElementById(e.id+self.idSuffix_fieldError);if(!s){s=document.createElement("div"),s.setAttribute("id",e.id+self.idSuffix_fieldError);var i=document.getElementById(e.id+self.idSuffix_fieldLabel);i?i.parentNode.insertBefore(s,i.nextSibling):e.parentNode.insertBefore(s,e.nextSibling)}s.appendChild(a),s.className+=" "+self.className_validationError_msg}},this.showAlert=function(e){alert(self.arrErrorMsg[8].replace("%%",e))}}function wUTILITY(){this.handlerList=new Array}wFORMS.prototype.onLoadHandler=function(){for(var e=0;e<document.forms.length;e++)document.forms[e].id||(document.forms[e].id=this.utilities.randomId()),this.addBehaviors(document.forms[e].id)},wFORMS.prototype.addBehaviors=function(fId){var f=document.getElementById(fId);if(f){var thisForm,wu=this.utilities;wu.resetEventList();for(var x=wu.getElements(f),i=0;i<x.length;i++){"FORM"==x[i].tagName.toUpperCase()&&(wu.XBrowserAddHandler(x[i],"submit",eval(this.functionName_formValidation)),thisForm=x[i]);var fh=document.getElementById(x[i].id+this.idSuffix_fieldHint);if(fh||"INPUT"!=x[i].tagName.toUpperCase()||"radio"!=x[i].type.toLowerCase()||(fh=document.getElementById(x[i].name+this.idSuffix_fieldHint)),fh&&(wu.XBrowserAddHandler(x[i],"focus",this.activateFieldHint),wu.XBrowserAddHandler(x[i],"blur",this.desactivateFieldHint)),x[i].className&&-1!=x[i].className.indexOf(this.classNamePrefix_switch))switch(x[i].tagName.toUpperCase()){case"OPTION":var sel=x[i].parentNode;"OPTGROUP"==sel.tagName.toUpperCase()&&(sel=sel.parentNode),wu.isEventHandled(sel,"change")||wu.XBrowserAddHandler(sel,"change",this.refreshState);break;case"INPUT":if(x[i].type&&"radio"==x[i].type.toLowerCase()){thisForm||(thisForm=x[i].form);for(var j=0;j<thisForm[x[i].name].length;j++)"radio"==thisForm[x[i].name][j].type&&wu.XBrowserAddHandler(thisForm[x[i].name][j],"click",this.refreshState)}else wu.XBrowserAddHandler(x[i],"click",this.refreshState);break;default:wu.XBrowserAddHandler(x[i],"click",this.refreshState)}if(x[i].className&&-1!=(" "+x[i].className+" ").indexOf(" "+this.className_paging+" ")){var currentPageIndex=parseInt(x[i].id.replace(/[\D]*/,""));if(currentPageIndex>1){var actionNode=document.createElement("input");actionNode.setAttribute("value",this.arrMsg[5]),actionNode.setAttribute("type","button"),actionNode.className=this.className_pagingButtons,x[i].appendChild(actionNode),wu.XBrowserAddHandler(actionNode,"click",this.pagingPrevious)}else{if(x[i].className+=" "+this.className_pagingCurrent,!thisForm)for(thisForm=x[i].parentNode;thisForm&&"FORM"!=thisForm.tagName.toUpperCase();)thisForm=thisForm.parentNode;var submitButton=document.getElementById("submit-"+thisForm.id);submitButton&&(submitButton.className=this.className_hideSubmit),this.preventSubmissionOnEnter=!0}if(document.getElementById(this.idPrefix_pageIndex+(currentPageIndex+1).toString())){var actionNode=document.createElement("input");actionNode.setAttribute("value",this.arrMsg[4]),actionNode.setAttribute("type","button"),actionNode.className=this.className_pagingButtons,x[i].appendChild(actionNode),wu.XBrowserAddHandler(actionNode,"click",this.pagingNext)}}if(x[i].className&&-1!=(" "+x[i].className+" ").indexOf(" "+this.className_repeat+" ")){wu.debug("adding repeat on "+x[i].id);var actionNode=null;if(x[i].id&&(actionNode=document.getElementById(x[i].id+this.idSuffix_duplicateLink)),!actionNode){actionNode=document.createElement("a");var spanNode=document.createElement("span"),textNode=document.createTextNode(this.arrMsg[0]);if(actionNode.setAttribute("href","#"),actionNode.className=this.className_duplicateLink,actionNode.setAttribute("title",this.arrMsg[1]),"TR"==x[i].tagName.toUpperCase()){for(var n=x[i].lastChild;n&&1!=n.nodeType;)n=n.previousSibling;n&&1==n.nodeType&&n.appendChild(actionNode)}else x[i].appendChild(actionNode);spanNode.appendChild(textNode),actionNode.appendChild(spanNode)}var counterField=document.getElementById(x[i].id+this.idSuffix_repeatCounter);if(!counterField){if(document.all&&!window.opera){var counterFieldId=x[i].id+this.idSuffix_repeatCounter;counterField=-1!=navigator.appVersion.indexOf("MSIE")&&-1==navigator.appVersion.indexOf("Windows")?document.createElement('INPUT NAME="'+counterFieldId+'"'):document.createElement('<INPUT NAME="'+counterFieldId+'"></INPUT>'),counterField.type="hidden",counterField.id=counterFieldId,counterField.value="1"}else counterField=document.createElement("INPUT"),counterField.setAttribute("type","hidden"),counterField.setAttribute("value","1"),counterField.setAttribute("name",x[i].id+this.idSuffix_repeatCounter),counterField.setAttribute("id",x[i].id+this.idSuffix_repeatCounter);if(!thisForm)for(thisForm=x[i].parentNode;thisForm&&"FORM"!=thisForm.tagName.toUpperCase();)thisForm=thisForm.parentNode;thisForm.appendChild(counterField)}wu.XBrowserAddHandler(actionNode,"click",this.duplicateFieldGroup)}if(x[i].className&&-1!=(" "+x[i].className+" ").indexOf(" "+this.className_delete+" ")){wu.debug("adding remove on "+x[i].id);var actionNode=document.createElement("a"),spanNode=document.createElement("span"),textNode=document.createTextNode(this.arrMsg[2]);if(actionNode.setAttribute("href","#"),actionNode.className=this.className_removeLink,actionNode.setAttribute("title",this.arrMsg[3]),"TR"==x[i].tagName.toUpperCase()){for(var n=x[i].lastChild;n&&1!=n.nodeType;)n=n.previousSibling;n&&1==n.nodeType&&n.appendChild(actionNode)}else x[i].appendChild(actionNode);spanNode.appendChild(textNode),actionNode.appendChild(spanNode),wu.XBrowserAddHandler(actionNode,"click",this.removeFieldGroup)}}this.refreshAllStates(fId)}},wUTILITY.prototype.XBrowserAddHandler=function(target,eventName,handlerName){if(target){if(target.addEventListener)target.addEventListener(eventName,function(e){eval(handlerName)(e)},!1);else if(target.attachEvent)target.attachEvent("on"+eventName,function(e){eval(handlerName)(e)});else{var originalHandler=target["on"+eventName];originalHandler?target["on"+eventName]=function(e){originalHandler(e),eval(handlerName)(e)}:target["on"+eventName]=eval(handlerName)}var l=this.handlerList.length;this.handlerList[l]=new Array(2),this.handlerList[l][0]=target.id,this.handlerList[l][1]=eventName,this.debug("Handler added :"+target.id+" "+eventName)}},wUTILITY.prototype.isEventHandled=function(e,t){for(var a=0;a<this.handlerList.length;a++)if(this.handlerList[a][0]==e.id&&this.handlerList[a][1]==t)return!0;return!1},wUTILITY.prototype.resetEventList=function(){this.handlerList=new Array},wUTILITY.prototype.activateStylesheet=function(e){if(document.getElementsByTagName)var t=document.getElementsByTagName("link");else if(document.styleSheets)var t=document.styleSheets;for(var a=0;t[a];a++)-1!=t[a].href.indexOf(e)&&(t[a].disabled=!0,t[a].disabled=!1)},wUTILITY.prototype.randomId=function(){for(var e="",t=0;6>t;t++)e+=String.fromCharCode(97+Math.floor(24*Math.random()));return e},wUTILITY.prototype.getElements=function(e,t){if(t||(t=new Array),1==e.nodeType){t[t.length]=e;for(var a=0;a<e.childNodes.length;a++)this.getElements(e.childNodes[a],t);return t}},wUTILITY.prototype.getSrcElement=function(e){if(e||(e=window.event),e.target)var t=e.target;else var t=e.srcElement;return 3==t.nodeType&&(t=t.parentNode),"LABEL"==t.tagName.toUpperCase()&&t.getAttribute("for")&&(t=document.getElementById(t.getAttribute("for"))),t},wUTILITY.prototype.XBrowserPreventEventDefault=function(e){return e||(e=window.event),e.preventDefault?e.preventDefault():e.returnValue=!1,!1},wUTILITY.prototype.checkVisibility=function(e){if(window.getComputedStyle){var t="none"!=window.getComputedStyle(e,"").getPropertyValue("display").toLowerCase();t=t&&"hidden"!=window.getComputedStyle(e,"").getPropertyValue("visibility").toLowerCase()}else{if(!e.currentStyle)return!0;if(""==e.currentStyle.display)return!1;var t="none"!=e.currentStyle.display.toLowerCase();t=t&&"hidden"!=e.currentStyle.visibility.toLowerCase()}return e.parentNode?"BODY"!=e.parentNode.tagName.toUpperCase()&&t?this.checkVisibility(e.parentNode):t:!1},wUTILITY.prototype.debug=function(e){var t=document.getElementById("debugOutput");t&&(t.innerHTML=t.innerHTML+"<br />"+e)};var WFORM=new wFORMS;WFORM.utilities.activateStylesheet("wforms-jsonly.css"),WFORM.utilities.XBrowserAddHandler(window,"load",function(){WFORM.onLoadHandler()});